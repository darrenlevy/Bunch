var gameLogic;!function(a){function b(){return[c(),c(),c()]}function c(){for(var b=[],c=0;c<a.DECK_SIZE;c++)b[c]=[d(),e(),f(),g()];return b}function d(){var b=["♡","✌","☺"],c=Math.floor(100*Math.random()%a.NUMBER_OF_TYPES);return b[c]}function e(){var b=Math.floor(100*Math.random()%a.NUMBER_OF_TYPES)+1;return String(b)}function f(){var b=["pink","orange","green"],c=Math.floor(100*Math.random()%a.NUMBER_OF_TYPES);return b[c]}function g(){var b=["solid","dotted","double"],c=Math.floor(100*Math.random()%a.NUMBER_OF_TYPES);return b[c]}function h(){return{decks:b(),bunches:[],round:1,scores:[0,0]}}function i(b){return b>a.TOTAL_ROUNDS}function j(a){return a[0]==a[1]?[0,0]:a[0]>a[1]?[1,0]:[0,1]}function k(b,c){var d=0;if(0===b.length)return 0;for(var e=0;e<a.NUMBER_OF_ELEMENTS_PER_CARD;e++){for(var f=[],g=0;g<b.length;g++){var h=b[g][e];f.indexOf(h)<0&&f.push(h)}if(d+=(110-c)*f.length,1!==f.length&&f.length!==a.NUMBER_OF_TYPES)return-1}return d}function l(b,c,d,e,f,g){if(i(f))throw new Error("Can only make a move if the game is not over!");b||(b=h());for(var l=b.decks[f-1],m=[],n=0;n<c.length;n++)m.push(l[c[n]]);if(1===m.length)throw new Error("One card is not a legal move!");var o=k(m,d);if(0>o)throw new Error("That is not a legal move!");var p=angular.copy(g);p[e]+=o;var q=angular.copy(b.bunches);q.push({cardIndices:c,seconds:d});var r,s=null,t=angular.copy(f);q.length%a.NUMBER_OF_PLAYERS===1?r=1-e:(r=e,t++),i(t)&&(s=j(p),r=-1);var u={decks:b.decks,bunches:q,round:t,scores:p};return{endMatchScores:s,turnIndexAfterMove:r,stateAfterMove:u}}function m(a){var b=a.turnIndexBeforeMove,c=a.stateBeforeMove,d=a.move,e=a.move.stateAfterMove.bunches,f=e[e.length-1],g=f.cardIndices,h=f.seconds,i=c?c.round:1,j=c?c.scores:[0,0],k=l(c,g,h,b,i,j);if(!angular.equals(d,k))throw new Error("Move calculated="+angular.toJson(k,!0)+", move expected="+angular.toJson(d,!0))}a.DECK_SIZE=16,a.TOTAL_ROUNDS=3,a.NUMBER_OF_PLAYERS=2,a.NUMBER_OF_ELEMENTS_PER_CARD=4,a.NUMBER_OF_TYPES=3,a.getInitialState=h,a.createMove=l,a.checkMoveOk=m}(gameLogic||(gameLogic={}));var game;!function(a){function b(){translate.setTranslations(c()),translate.setLanguage("en"),log.log("Translation of 'RULES_OF_BUNCHES' is "+translate("RULES_OF_BUNCHES")),resizeGameAreaService.setWidthToHeight(1.5),moveService.setGame({minNumberOfPlayers:2,maxNumberOfPlayers:2,checkMoveOk:gameLogic.checkMoveOk,updateUI:f}),document.addEventListener("animationend",d,!1),document.addEventListener("webkitAnimationEnd",d,!1),document.addEventListener("oanimationend",d,!1);var a=window;a.HTMLInspector&&setInterval(function(){a.HTMLInspector.inspect({excludeRules:["unused-classes","script-placement"]})},3e3)}function c(){return{RULES_OF_BUNCHES:{en:"Rules of Bunches",es:"Reglas de Los Manojos"},RULES_SLIDE1:{en:"You and your opponent take turns finding a Bunch. A Bunch is 2 or 3 cards where the number of emoji, color of emoji, the emoji itself and border of the card are all the same or all different.",es:"Usted y su oponente se da vuelta para encontrar un manojo. Un manojo es 2 o 3 cartas donde el número de emoji, el color de emoji, el propio emoji y el borde de la tarjeta son todos iguales o diferentes."},RULES_SLIDE2:{en:"The first player goes, then the second player goes with the same cards for each round. After 3 rounds, the player with the most points wins.",es:"El primer jugador pasa, entonces el segundo jugador va con las mismas cartas para cada ronda. Después de 3 rondas, el jugador con más puntos gana."},CLOSE:{en:"Close",es:"Cerca"}}}function d(){$rootScope.$apply(function(){log.info("Animation ended"),a.animationEnded=!0,e()})}function e(){a.isComputerTurn&&(a.isComputerTurn=!1,moveService.makeMove(aiService.findComputerMove(a.move)))}function f(b){log.info("Game got updateUI:",b),a.animationEnded=!1,a.move=b.move,a.state=a.move.stateAfterMove,a.state||(a.state=gameLogic.getInitialState()),a.canMakeMove=a.move.turnIndexAfterMove>=0&&b.yourPlayerIndex===a.move.turnIndexAfterMove,a.isComputerTurn=a.canMakeMove&&""===b.playersInfo[b.yourPlayerIndex].playerId,a.isComputerTurn&&(a.canMakeMove=!1,a.state.bunches||e())}function g(b){var c=a.cards.indexOf(b);-1==c?a.cards.push(b):a.cards.splice(c,1)}function h(b,c,d,e){if(log.info("Clicked on cards:",b),"?throwException"===window.location.search)throw new Error("Throwing the error because URL has '?throwException'");if(a.canMakeMove)try{var f=gameLogic.createMove(a.state,b,c,a.move.turnIndexAfterMove,d,e);a.canMakeMove=!1,moveService.makeMove(f)}catch(g){return void log.info(["Invalid cards:",b])}}function i(b){for(var c="",d=parseInt(a.state.decks[a.state.round-1][b][1]),e=0;d>e;e++)c+=a.state.decks[a.state.round-1][b][0];return c}function j(b){return"green"==a.state.decks[a.state.round-1][b][2]}function k(b){return"pink"==a.state.decks[a.state.round-1][b][2]}function l(b){return"orange"==a.state.decks[a.state.round-1][b][2]}function m(b){return"solid"==a.state.decks[a.state.round-1][b][3]}function n(b){return"dotted"==a.state.decks[a.state.round-1][b][3]}function o(b){return"double"==a.state.decks[a.state.round-1][b][3]}function p(b){return b.target===b.currentTarget&&(b.preventDefault(),b.stopPropagation(),a.isHelpModalShown=!1),!0}a.animationEnded=!1,a.canMakeMove=!1,a.isComputerTurn=!1,a.move=null,a.state=null,a.isHelpModalShown=!1,a.cards=[],a.init=b,a.cardClicked=g,a.cellClicked=h,a.getEmoji=i,a.isGreen=j,a.isPink=k,a.isOrange=l,a.isSolid=m,a.isDotted=n,a.isDouble=o,a.clickedOnModal=p}(game||(game={})),angular.module("myApp",["ngTouch","ui.bootstrap","gameServices"]).run(function(){$rootScope.game=game,game.init()});var aiService;!function(a){function b(a){return d(a,{millisecondsLimit:1e3})}function c(a,b){for(var c=0;c<gameLogic.DECK_SIZE;c++)for(var d=0;d<gameLogic.DECK_SIZE;d++)try{return gameLogic.createMove(a,[c,d],30,b,a.round,a.scores)}catch(e){}return null}function d(a,b){return c(a.stateAfterMove,a.turnIndexAfterMove)}a.findComputerMove=b,a.getRandomMove=c,a.createComputerMove=d}(aiService||(aiService={}));
//# sourceMappingURL=everything.min.js.map